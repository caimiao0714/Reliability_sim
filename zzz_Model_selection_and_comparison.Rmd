---
title: 'Model selection and comparison: Bayesian models'
author: "Miao Cai"
date: "`r Sys.Date()`"
output:
  bookdown::pdf_document2: 
    number_sections: true
    toc: true
header-includes:
  - \usepackage{soul}
  - \usepackage{float}
  - \usepackage{graphicx}
  - \usepackage{setspace}\linespread{1.2}
geometry: "left=2cm,right=2cm,top=2cm,bottom=2cm"
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# p_loo and Pareto k values

This a quick note on different cases why Pareto k values can be large. I’ll try to extend this to a longer explanation and a case study. Any feedback on this draft is appreciated

- If all Pareto $k$ small, model is likely to be ok (although there can be better models)
- If high Pareto $k$ values
    + If `p_loo` << the number of parameters $p$, then the model is likely to be misspecified. PPC is likely to detect the problem, too. Try using overdispersed model, or add more structural information (nonlinearity, mixture model, etc.).
    + If `p_loo` > the number of parameters $p$, then the model is likely to be badly misspecified. If the number of parameters p<<n, then PPC is likely to detect the problem, too. Case example [https://rawgit.com/avehtari/modelselection_tutorial/master/roaches.html](https://rawgit.com/avehtari/modelselection_tutorial/master/roaches.html) 41
    + If `p_loo` > the number of parameters $p$, then the model is likely to be badly misspecified. If the number of parameters $p$ is relatively large compared to the number of observations p>n/5 (more accurately we should count number of observations influencing each parameter as in hierarchical models some groups may have small n and some groups large n), it is possible that PPC doesn’t detect the problem. Case example Recommendations for what to do when k exceeds 0.5 in the loo package? 58
    + If `p_loo` < the number of parameters $p$ and the number of parameters $p$ is relatively large compared to the number of observations p>n/5, it is likely that model is so flexible or population prior is so weak that it’s difficult to predict for left out observation even if the model is true one. Case example is the simulated 8 schools in [https://arxiv.org/abs/1507.04544](https://arxiv.org/abs/1507.04544) 24 and Gaussian processes and spatial models with short correlation lengths.